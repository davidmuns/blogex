<mat-toolbar class="toolbarClass">

  <mat-toolbar-row class="toolbar">
    <img class="logo" src="../../../assets/img/logo-blogex.jpg" alt="logo-blogex" (click)="onHome()">
    <app-search></app-search>
    <div class="buttons">
      <ng-container *ngIf="!isMobile; else mobile">
        <!-- HOME BUTTON -->
        <button mat-icon-button aria-label="home" (click)="onHome()">
          <mat-icon>home</mat-icon>
        </button>
        <!-- INFO BUTTON -->
        <button mat-icon-button aria-label="info" (click)="onHelp()">
          <mat-icon>help</mat-icon>
        </button>
        <!-- LANGUAGE BUTTON  -->
        <button mat-icon-button aria-label="language" [matMenuTriggerFor]="language_menu">
          <mat-icon>language</mat-icon>
        </button>
        <!-- USER BUTTON -->
        <button mat-icon-button aria-label="user" (click)="openLogin()" *ngIf="!this.tokenService.isLogged(); else logged">
          <mat-icon>account_circle</mat-icon>
        </button>
        <!-- LOGGED BUTTON -->
        <ng-template #logged>
          <button 
            class="logout"
            matTooltip="{{ tokenService.getUsername() }}" 
            [matMenuTriggerFor]="user_menu" 
            #menuTrigger="matMenuTrigger"
            (mouseover)="openMenu(menuTrigger)">
            {{ tokenService.getUsername()?.charAt(0)?.toUpperCase() }}
          </button>
        </ng-template>
      </ng-container>

      <ng-template #mobile>

        <button mat-icon-button [matMenuTriggerFor]="user_menu" #menuTrigger="matMenuTrigger"
          (mouseover)="openMenu(menuTrigger)" *ngIf="!this.tokenService.isLogged(); else logged">
          <mat-icon>menu</mat-icon>
        </button>

        <ng-template #logged>
          <button 
            class="logout"
            matTooltip="{{ tokenService.getUsername() }}" 
            [matMenuTriggerFor]="user_menu" 
            #menuTrigger="matMenuTrigger"
            (mouseover)="openMenu(menuTrigger)">
            {{ tokenService.getUsername()?.charAt(0)?.toUpperCase() }}
          </button>
        </ng-template>
      </ng-template>
    </div>
  </mat-toolbar-row>


  <!-- LANGUAGE MENU -->
  <mat-menu #language_menu>
    <!-- CATALAN -->
    <button mat-menu-item (click)="onSwitchLang('ca')">
      <mat-icon></mat-icon>
      <img [src]="this.urlFlags.catalonia" alt="catalan-flag" title="català" width="20" height="20">
      Català
    </button>
    <mat-divider></mat-divider>
    <!-- SPANISH -->
    <button mat-menu-item (click)="onSwitchLang('es')">
      <mat-icon></mat-icon>
      <img [src]="this.urlFlags.spain" alt="spain-flag" title="català" width="20" height="20">
      Español
    </button>
    <mat-divider></mat-divider>
    <!-- ENGLISH -->
    <button mat-menu-item (click)="onSwitchLang('en')">
      <mat-icon></mat-icon>
      <img [src]="this.urlFlags.england" alt="catalan-flag" title="català" width="20" height="20">
      English
    </button>
  </mat-menu>

  <!-- USER MENU -->
  <mat-menu id="matMenu" #user_menu>
    <!-- HOME BUTTON -->
    <button mat-menu-item (click)="onHome()" *ngIf="isMobile">
      <mat-icon>home</mat-icon>
      {{ 'Home' | translate }}
    </button>
    <mat-divider *ngIf="isMobile"></mat-divider>

    <!-- MY BLOG BUTTON -->
    <button mat-menu-item routerLink="/blog/{{ this.tokenService.getUsername() }}" *ngIf="this.tokenService.isLogged()">
      <mat-icon>book</mat-icon>
      {{ 'Blog' | translate }}
    </button>
    <mat-divider *ngIf="this.tokenService.isLogged()"></mat-divider>

    <!-- ARTICLE EDITOR BUTTON -->
    <button mat-menu-item routerLink="/admin/new" *ngIf="this.tokenService.isLogged()">
      <mat-icon>edit</mat-icon>
      {{ 'header.articles-editor' | translate }}
    </button>
    <mat-divider *ngIf="this.tokenService.isLogged()"></mat-divider>

    <!-- MY ARTICLES BUTTON -->
    <button mat-menu-item routerLink="/articles" *ngIf="this.tokenService.isLogged()">
      <mat-icon>article</mat-icon>
      {{ 'header.my-articles' | translate }}
    </button>
    <mat-divider *ngIf="this.tokenService.isLogged()"></mat-divider>

    <!-- CATALAN BUTTON -->
    <button mat-menu-item (click)="onSwitchLang('ca')" *ngIf="isMobile">
      <mat-icon>language</mat-icon>
      <img [src]="this.urlFlags.catalonia" alt="catalan-flag" title="català" width="20" height="20">
      Català
    </button>
    <mat-divider *ngIf="isMobile"></mat-divider>

    <!-- SPANISH BUTTON -->
    <button mat-menu-item (click)="onSwitchLang('es')" *ngIf="isMobile">
      <mat-icon>language</mat-icon>
      <img [src]="this.urlFlags.spain" alt="spain-flag" title="català" width="20" height="20">
      Español
    </button>
    <mat-divider *ngIf="isMobile"></mat-divider>

    <!-- ENGLISH BUTTON -->
    <button mat-menu-item (click)="onSwitchLang('en')" *ngIf="isMobile">
      <mat-icon>language</mat-icon>
      <img [src]="this.urlFlags.england" alt="catalan-flag" title="català" width="20" height="20">
      English
    </button>
    <mat-divider *ngIf="isMobile"></mat-divider>

    <!-- INFO BUTTON -->
    <button mat-menu-item (click)="onHelp()" *ngIf="isMobile">
      <mat-icon>help</mat-icon>
      {{ 'header.help' | translate }}
    </button>
    <mat-divider *ngIf="isMobile"></mat-divider>

    <!-- LOGIN BUTTON -->
    <button mat-menu-item (click)="openLogin()" *ngIf="!this.tokenService.isLogged() && isMobile">
      <mat-icon>login</mat-icon>
      {{ 'Login' | translate }}
    </button>

    <!-- LOGOUT BUTTON -->
    <button mat-menu-item (click)="onLogout()" *ngIf="this.tokenService.isLogged()">
      <mat-icon>logout</mat-icon>
      {{ 'Logout' | translate }}
    </button>
    <mat-divider *ngIf="this.tokenService.isLogged()"></mat-divider>

    <!-- FAKE BUTTON -->
    <button mat-menu-item *ngIf="this.tokenService.isLogged()"></button>
    <mat-divider *ngIf="this.tokenService.isLogged()"></mat-divider>

    <!-- DELETE USER BUTTON -->
    <button mat-menu-item (click)="onDeleteAccount()" *ngIf="this.tokenService.isLogged()">
      <mat-icon>delete</mat-icon>
      {{ 'Delete' | translate }} {{ 'delete.account' | translate }}
    </button>
  </mat-menu>